---
import Animation from './animation/Animation.astro'
import { getEntry } from 'astro:content'

const c1 = await getEntry('spec', 'console-1')!
const c2 = await getEntry('spec', 'console-2')!
const c3 = await getEntry('spec', 'console-3')!

const console_string = c1.body?.split('\n').join('^200\n')
---



<div id="console">
  <noscript><Animation isNoScript={true}/></noscript>
    <span class="text-orange-600">neoenanos@sumeria</span><span>:~$ </span>
    <span id="user-input-1"></span>
    <span id="typed-1"></span>
  </div>
</div>


<Animation/>



<script >
  import Typed from 'typed.js'
  const consolita = document.getElementById('console')!

  function wasUserAtBottom() {
    const tolerance = 20
    return consolita.scrollTop + consolita.clientHeight >= consolita.scrollHeight - tolerance
  }

  function scrollToBottom() {
    consolita.scrollTop = consolita.scrollHeight
  }
  let atBottom = true

  // const _host1 = new Typed('#host-1',{
  //   showCursor: false,
  //   typeSpeed: 0,
  //   strings: [document.getElementById('host-template')!.getHTML()]
  // })
  const _userinput1 = new Typed('#user-input-1',{
    showCursor: false,
    typeSpeed: 60,
    strings: ['viruscan lit --recursive ./']
  })

  const strings =  [document.getElementById('log-1')!.getHTML()]

  const _typed = new Typed('#typed-1', {
    strings,
    typeSpeed: 1,
    backSpeed: 0,
    contentType: 'html',
        

    // PA QUE ESTO FUNCIONE HAY QUE PONER ALGUNA PAUSA QUE SEA EN LA CAGA ESA 
    onTypingPaused: () => {
      atBottom = wasUserAtBottom()
    },
    onTypingResumed: () => {
      if (atBottom) {
        scrollToBottom()
      }
    },
  })
</script>

<style>
  #console {
    font-family: monospace;
    background: #000;
    border: 1px solid #444;
    padding: 10px;
    height: 300px;
    overflow-y: scroll;
    white-space: pre-wrap;
  }
</style>
